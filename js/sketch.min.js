let images=[],cards=[],flipSound,matchSound,firstCard,isMouseClickEnabled=!0,isRestartEnabled=!0;const canvasWidth=550,canvasHeight=590,canvasBackground="#90CCF4",numRows=4,numColumns=3,mcardWidth=110,mcardHeight=160,borderMargin=40,betweenCardsMargin=10;let numOfMatchedCards=0,score=100,highScore=getHighscore()?getHighscore():0;const numOfImages=19;function preload(){for(let i=1;i<=19;i++){let image=loadImage(`images/animals/${i}.webp`);images.push(image)}flipSound=loadSound("sounds/flip.mp3"),matchSound=loadSound("sounds/match.mp3")}function setup(){let canvas=createCanvas(550,590,WEBGL);canvas.parent("sketch"),canvas.touchEnded(mouseClicked),rectMode(CENTER),angleMode(DEGREES),shuffleCards(),updateScore(score),updateNumOfMatchedCards(numOfMatchedCards),updateHighscore(highScore)}function draw(){background("#90CCF4"),cards.forEach(tile=>tile.render())}function mouseClicked(){isMouseClickEnabled&&!modalOpen&&cards.forEach(tile=>{mouseX>tile.x&&mouseX<tile.x+110&&mouseY>tile.y&&mouseY<tile.y+160&&(tile.faceUp||(flipSound.play(),tile.turn(),firstCard?firstCard.id===tile.id?(firstCard=null,matchSound.play(),numOfMatchedCards++,updateNumOfMatchedCards(numOfMatchedCards),6===numOfMatchedCards&&(score>highScore&&(highScore=score,saveHighscore(score)),openModal())):(isMouseClickEnabled=isRestartEnabled=!1,setTimeout(()=>{firstCard.turn(),tile.turn(),firstCard=null,isMouseClickEnabled=isRestartEnabled=!0},1e3),score-=10,updateScore(score)):firstCard=tile))})}function shuffleCards(){cards=[],images.sort(()=>Math.random()-.5);for(let i=0;i<6;i++)cards.push(new Card(images[i],i)),cards.push(new Card(images[i],i));cards.sort(()=>Math.random()-.5);let index=0;for(let i=0;i<4;i++)for(let j=0;j<3;j++)cards[index].setCoords(110*i+10*i+40,160*j+10*j+40),index++}function restartGame(){isRestartEnabled&&(isRestartEnabled=isMouseClickEnabled=!1,cards.forEach(tile=>{tile.faceUp=!1}),setTimeout(()=>{shuffleCards(),score=100,numOfMatchedCards=0,firstCard=null,updateScore(score),updateNumOfMatchedCards(numOfMatchedCards),isRestartEnabled=isMouseClickEnabled=!0},500))}